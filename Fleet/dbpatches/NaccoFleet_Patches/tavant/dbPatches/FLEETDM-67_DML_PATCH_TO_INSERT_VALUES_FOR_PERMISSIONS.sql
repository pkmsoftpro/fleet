--PURPOSE    : PATCH TO ADD TABLE TRAVEL_RATE_EXCEPTIONS
--AUTHOR     : SUSHMA MANTHALE
--CREATED ON : 16-JULY-13
--PURPOSE    : PATCH TO ADD TABLE TRAVEL_RATE_EXCEPTIONS
--AUTHOR     : SUSHMA MANTHALE
--CREATED ON : 16-JULY-13
INSERT INTO ROLE(ID,NAME,DISPLAY_NAME,ROLE_TYPE,version,d_created_time,d_updated_time,description) VALUES(ROLE_SEQ.NEXTVAL,'fleetServiceSpecialist','fleet Service Specialist','INTERNAL',0,sysdate,sysdate,'Fleet Service Specialist')
/
Insert into MST_ADMIN_ACTION (ID,ACTION,DESCRIPTION) values (1,'view','View')
/
Insert into MST_ADMIN_ACTION (ID,ACTION,DESCRIPTION) values (2,'create','Create')
/
Insert into MST_ADMIN_ACTION (ID,ACTION,DESCRIPTION) values (3,'delete','Delete')
/
INSERT INTO MST_ADMIN_ACTION (ID,ACTION,DESCRIPTION) VALUES (4,'update','Update')
/
Insert into MST_ADMIN_ACTION (ID,ACTION,DESCRIPTION) values (5,'search','search')
/
INSERT INTO MST_ADMIN_FNC_AREA VALUES (MST_ADMIN_FNC_AREA_SEQ.nextval,'quoteTab','quote Tab')
/
INSERT INTO MST_ADMIN_SUBJECT_AREA VALUES (MST_ADMIN_FNC_AREA_SEQ.nextval,'quote','Quote')
/
INSERT INTO SUBJECT_FUNC_AREA_MAPPING (FUNCTIONAL_AREA,SUBJECT_AREA) VALUES ((SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='quoteTab'),
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='quote'))
/
INSERT INTO ROLE_PERMISSION_MAPPING(ROLE_DEF_ID, ACTION ,FUNCTIONAL_AREA, ID , SUBJECT_AREA) 
VALUES ( (SELECT ID FROM ROLE WHERE NAME ='customer'),(SELECT ID FROM MST_ADMIN_ACTION WHERE action = 'update'), 
(SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='quoteTab'), ROLE_PERMISSION_MAPPING_SEQ.NEXTVAL ,
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='quote'))
/
INSERT INTO ROLE_PERMISSION_MAPPING(ROLE_DEF_ID, ACTION ,FUNCTIONAL_AREA, ID , SUBJECT_AREA) 
VALUES ( (SELECT ID FROM ROLE WHERE NAME ='dealer'),(SELECT ID FROM MST_ADMIN_ACTION WHERE action = 'update'), 
(SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='quoteTab'), ROLE_PERMISSION_MAPPING_SEQ.NEXTVAL ,
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='quote'))
/
INSERT INTO ROLE_PERMISSION_MAPPING(ROLE_DEF_ID, ACTION ,FUNCTIONAL_AREA, ID , SUBJECT_AREA) 
VALUES ( (SELECT ID FROM ROLE WHERE NAME ='fleetServiceSpecialist'),(SELECT ID FROM MST_ADMIN_ACTION WHERE action = 'update'), 
(SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='quoteTab'), ROLE_PERMISSION_MAPPING_SEQ.NEXTVAL ,
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='quote'))
/
INSERT INTO MST_ADMIN_FNC_AREA VALUES (MST_ADMIN_FNC_AREA_SEQ.nextval,'createQuote','create quote')
/
INSERT INTO SUBJECT_FUNC_AREA_MAPPING (FUNCTIONAL_AREA,SUBJECT_AREA) VALUES ((SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='createQuote'),
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='quote'))
/
INSERT INTO ROLE_PERMISSION_MAPPING(ROLE_DEF_ID, ACTION ,FUNCTIONAL_AREA, ID , SUBJECT_AREA) 
VALUES ( (SELECT ID FROM ROLE WHERE NAME ='dealer'),(SELECT ID FROM MST_ADMIN_ACTION WHERE action = 'update'), 
(SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='createQuote'), ROLE_PERMISSION_MAPPING_SEQ.NEXTVAL ,
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='quote'))
/
INSERT INTO MST_ADMIN_FNC_AREA VALUES (MST_ADMIN_FNC_AREA_SEQ.nextval,'serviceRequestTab','Service Request Tab')
/
INSERT INTO MST_ADMIN_SUBJECT_AREA VALUES (MST_ADMIN_FNC_AREA_SEQ.nextval,'serviceRequest','Service Request')
/
INSERT INTO SUBJECT_FUNC_AREA_MAPPING (FUNCTIONAL_AREA,SUBJECT_AREA) VALUES ((SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='serviceRequestTab'),
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='serviceRequest'))
/
INSERT INTO ROLE_PERMISSION_MAPPING(ROLE_DEF_ID, ACTION ,FUNCTIONAL_AREA, ID , SUBJECT_AREA) 
VALUES ( (SELECT ID FROM ROLE WHERE NAME ='customer'),(SELECT ID FROM MST_ADMIN_ACTION WHERE action = 'update'), 
(SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='serviceRequestTab'), ROLE_PERMISSION_MAPPING_SEQ.NEXTVAL ,
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='serviceRequest'))
/
INSERT INTO ROLE_PERMISSION_MAPPING(ROLE_DEF_ID, ACTION ,FUNCTIONAL_AREA, ID , SUBJECT_AREA) 
VALUES ( (SELECT ID FROM ROLE WHERE NAME ='dealer'),(SELECT ID FROM MST_ADMIN_ACTION WHERE action = 'update'), 
(SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='serviceRequestTab'), ROLE_PERMISSION_MAPPING_SEQ.NEXTVAL ,
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='serviceRequest'))
/
INSERT INTO ROLE_PERMISSION_MAPPING(ROLE_DEF_ID, ACTION ,FUNCTIONAL_AREA, ID , SUBJECT_AREA) 
VALUES ( (SELECT ID FROM ROLE WHERE NAME ='fleetServiceSpecialist'),(SELECT ID FROM MST_ADMIN_ACTION WHERE action = 'update'), 
(SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='serviceRequestTab'), ROLE_PERMISSION_MAPPING_SEQ.NEXTVAL ,
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='serviceRequest'))
/
INSERT INTO MST_ADMIN_FNC_AREA VALUES (MST_ADMIN_FNC_AREA_SEQ.nextval,'createServiceRequest','Create Service Request')
/
INSERT INTO SUBJECT_FUNC_AREA_MAPPING (FUNCTIONAL_AREA,SUBJECT_AREA) VALUES ((SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='createServiceRequest'),
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='serviceRequest'))
/
INSERT INTO ROLE_PERMISSION_MAPPING(ROLE_DEF_ID, ACTION ,FUNCTIONAL_AREA, ID , SUBJECT_AREA) 
VALUES ( (SELECT ID FROM ROLE WHERE NAME ='customer'),(SELECT ID FROM MST_ADMIN_ACTION WHERE action = 'update'), 
(SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='createServiceRequest'), ROLE_PERMISSION_MAPPING_SEQ.NEXTVAL ,
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='serviceRequest'))
/
INSERT INTO ROLE_PERMISSION_MAPPING(ROLE_DEF_ID, ACTION ,FUNCTIONAL_AREA, ID , SUBJECT_AREA) 
VALUES ( (SELECT ID FROM ROLE WHERE NAME ='dealer'),(SELECT ID FROM MST_ADMIN_ACTION WHERE action = 'update'), 
(SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='createServiceRequest'), ROLE_PERMISSION_MAPPING_SEQ.NEXTVAL ,
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='serviceRequest'))
/
INSERT INTO ROLE_PERMISSION_MAPPING(ROLE_DEF_ID, ACTION ,FUNCTIONAL_AREA, ID , SUBJECT_AREA) 
VALUES ( (SELECT ID FROM ROLE WHERE NAME ='fleetServiceSpecialist'),(SELECT ID FROM MST_ADMIN_ACTION WHERE action = 'update'), 
(SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='createServiceRequest'), ROLE_PERMISSION_MAPPING_SEQ.NEXTVAL ,
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='serviceRequest'))
/
INSERT INTO MST_ADMIN_FNC_AREA VALUES (MST_ADMIN_FNC_AREA_SEQ.nextval,'fleetAdminTab','Fleet Admin Tab')
/
INSERT INTO MST_ADMIN_SUBJECT_AREA VALUES (MST_ADMIN_FNC_AREA_SEQ.nextval,'fleetadmin','Fleet Admin')
/
INSERT INTO SUBJECT_FUNC_AREA_MAPPING (FUNCTIONAL_AREA,SUBJECT_AREA) VALUES ((SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='fleetAdminTab'),
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='fleetadmin'))
/
INSERT INTO ROLE_PERMISSION_MAPPING(ROLE_DEF_ID, ACTION ,FUNCTIONAL_AREA, ID , SUBJECT_AREA) 
VALUES ( (SELECT ID FROM ROLE WHERE NAME ='admin'),(SELECT ID FROM MST_ADMIN_ACTION WHERE action = 'update'), 
(SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='fleetAdminTab'), ROLE_PERMISSION_MAPPING_SEQ.NEXTVAL ,
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='fleetadmin'))
/
INSERT INTO MST_ADMIN_FNC_AREA VALUES (MST_ADMIN_FNC_AREA_SEQ.nextval,'dealerType','service Request Dealer Type')
/
INSERT INTO SUBJECT_FUNC_AREA_MAPPING (FUNCTIONAL_AREA,SUBJECT_AREA) VALUES ((SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='dealerType'),
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='serviceRequest'))
/
INSERT INTO MST_ADMIN_FNC_AREA VALUES (MST_ADMIN_FNC_AREA_SEQ.nextval,'manageBusinessConfigurations','Manage Business Configurations')
/
INSERT INTO SUBJECT_FUNC_AREA_MAPPING (FUNCTIONAL_AREA,SUBJECT_AREA) VALUES ((SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='manageBusinessConfigurations'),
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='fleetadmin'))
/
INSERT INTO ROLE_PERMISSION_MAPPING(ROLE_DEF_ID, ACTION ,FUNCTIONAL_AREA, ID , SUBJECT_AREA) 
VALUES ( (SELECT ID FROM ROLE WHERE NAME ='admin'),(SELECT ID FROM MST_ADMIN_ACTION WHERE action = 'update'), 
(SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='manageBusinessConfigurations'), ROLE_PERMISSION_MAPPING_SEQ.NEXTVAL ,
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='fleetadmin'))
/
INSERT INTO MST_ADMIN_FNC_AREA VALUES (MST_ADMIN_FNC_AREA_SEQ.nextval,'createQuoteInboxes','create quote inboxes')
/
INSERT INTO SUBJECT_FUNC_AREA_MAPPING (FUNCTIONAL_AREA,SUBJECT_AREA) VALUES ((SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='createQuoteInboxes'),
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='quote'))
/
INSERT INTO ROLE_PERMISSION_MAPPING(ROLE_DEF_ID, ACTION ,FUNCTIONAL_AREA, ID , SUBJECT_AREA) 
VALUES ( (SELECT ID FROM ROLE WHERE NAME ='dealer'),(SELECT ID FROM MST_ADMIN_ACTION WHERE action = 'update'), 
(SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='createQuoteInboxes'), ROLE_PERMISSION_MAPPING_SEQ.NEXTVAL ,
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='quote'))
/
INSERT INTO ROLE_PERMISSION_MAPPING(ROLE_DEF_ID, ACTION ,FUNCTIONAL_AREA, ID , SUBJECT_AREA) 
VALUES ( (SELECT ID FROM ROLE WHERE NAME ='customer'),(SELECT ID FROM MST_ADMIN_ACTION WHERE action = 'update'), 
(SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='createQuoteInboxes'), ROLE_PERMISSION_MAPPING_SEQ.NEXTVAL ,
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='quote'))
/
INSERT INTO ROLE_PERMISSION_MAPPING(ROLE_DEF_ID, ACTION ,FUNCTIONAL_AREA, ID , SUBJECT_AREA) 
VALUES ( (SELECT ID FROM ROLE WHERE NAME ='fleetServiceSpecialist'),(SELECT ID FROM MST_ADMIN_ACTION WHERE action = 'update'), 
(SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='createQuoteInboxes'), ROLE_PERMISSION_MAPPING_SEQ.NEXTVAL ,
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='quote'))
/
INSERT INTO MST_ADMIN_FNC_AREA VALUES (MST_ADMIN_FNC_AREA_SEQ.nextval,'afterBusinessHours','After Business hours')
/
INSERT INTO SUBJECT_FUNC_AREA_MAPPING (FUNCTIONAL_AREA,SUBJECT_AREA) VALUES ((SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='afterBusinessHours'),
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='serviceRequest'))
/
INSERT INTO ROLE_PERMISSION_MAPPING(ROLE_DEF_ID, ACTION ,FUNCTIONAL_AREA, ID , SUBJECT_AREA) 
VALUES ( (SELECT ID FROM ROLE WHERE NAME ='customer'),(SELECT ID FROM MST_ADMIN_ACTION WHERE action = 'update'), 
(SELECT ID FROM MST_ADMIN_FNC_AREA WHERE NAME='afterBusinessHours'), ROLE_PERMISSION_MAPPING_SEQ.NEXTVAL ,
(SELECT ID FROM MST_ADMIN_SUBJECT_AREA WHERE NAME='serviceRequest'))
/
UPDATE ROLE_PERMISSION_MAPPING A SET A.PERMISSION_STRING = (SELECT NAME FROM mst_admin_subject_area WHERE ID = A.subject_area ) || ':' ||
(select name from MST_ADMIN_FNC_AREA where id = a.FUNCTIONAL_AREA) || ':' || (select T.ACTION from MST_ADMIN_ACTION T where id = a.ACTION)
/